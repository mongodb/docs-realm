=====================
Define a Realm Schema
=====================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

Overview
--------


In modern applications, users update their data continuously. Users also
expect their data to be available and accurate cross-platform and in
realtime. Storing your data in `MongoDB Atlas
<http://www.mongodb.com/cloud/atlas/>`_ ensures the availability of
your data. Also, using schemas ensures the accuracy of the data by
performing type and format checks on fields. 

There are two different types of schemas you will need: a :doc:`Realm
Database Schema </data-model/realms>`, for your mobile application, and
a :doc:`JSON Schema </mongodb/document-schemas>`, for your MongoDB Atlas
cluster. 

You may have already started storing your application data on MongoDB
Atlas, in which case you can generate a JSON Schema through ``Automated
Schema Generation with MongoDB Realm`` and translate that JSON Schema
into the Realm Database Schema you need for mobile. Alternatively, if you
have not started storing your application data yet in Atlas,
``Development Mode with MongoDB Realm`` allows you to create both
the schemas that you will need.

.. note:: 

  There are some differences between `JSON Schema
  <https://json-schema.org/>`_ and Realm Database Schemas: the structure
  of relationships, restrictions on certain data
  types. To learn more, read the :doc:`Realm Database Restrictions
  </realm-database-restrictions>` page. 

Automated Schema Generation with MongoDB Realm
----------------------------------------------

You can create a JSON Schema if you already have data in MongoDB Atlas.
Navigate through the MongoDB Realm UI to sample the data in your
collection to automatically generate a schema. You can then edit that
schema and translate it into a Realm Database Schema for the language of
your choice. 

Procedure
~~~~~~~~~

#. Sign up for Atlas and create a cluster.
#. Create a MongoDB Realm application.
#. Navigate to the ``SDKs`` page to link your MongoDB Realm application to your Atlas Cluster.
#. In the ``rules`` page, click ``Generate Schema`` to automatically create a JSON Schema based on your cluster data.

   .. figure:: /images/generate-schema-based-on-cluster-data.png
      :width: 750px
      :lightbox:

#. Edit your ``JSON Schema``.

   .. figure:: /images/edit-schema-based-on-cluster-data.png
      :width: 750px
      :lightbox:

#. In the ``SDKs`` page, view your ``JSON Schema`` as a Realm Database Schema in your language of choice.

   .. figure:: /images/translate-jsonschema-into-realm-data-model.png
      :width: 750px
      :lightbox:

#. Click ``View all Schema Errors`` to see the errors & warnings from translating your ``JSON Schema`` into a Realm Database Schema.

   .. figure:: /images/schema-translation-errors-warnings.png
      :width: 750px
      :lightbox:

Development Mode with MongoDB Realm
-----------------------------------

You can create a JSON Schema suitable for MongoDB Atlas so that you can
take your application to production. Through ``Development Mode`` in the
MongoDB Realm UI, you can develop your Realm Database Schema. After
developing your Realm Database Schema, MongoDB will automatically
generate a JSON Schema for your Atlas cluster. 

Procedure
~~~~~~~~~

#. Sign up for Atlas and create a cluster.
#. Create a MongoDB Realm application.
#. Navigate to the ``SDKs`` page to link your MongoDB Realm application to your Atlas Cluster.
#. Enable ``Development Mode``, automatically, by navigating to the ``SDKs`` page.

   .. figure:: /images/enable-schema-development-mode.png
      :width: 750px
      :lightbox:

#. Create a Realm Database Schema in the language of your choice with the Realm Client SDKs.

   .. figure:: /images/define-your-data-models.png
      :width: 750px
      :lightbox:

#. Alter ``Validation Settings`` on the ``Sync`` page.

   .. figure:: /images/alter-validation-settings.png
      :width: 750px
      :lightbox:
      
#. Click ``Save``.
#. A modal will appear, click ``View my JSON Schema`` to view your generated schema for Atlas.

   .. figure:: /images/view-my-json-schema.png
      :width: 461px
      :lightbox: 
      
Summary
-------
- If you already have application data stored in MongoDB Atlas, you can translate your automatically-generated schema into a Realm Database Schema to use for your Realm Mobile Application.
- If you want to take your Realm app to production but do not already have application data stored in MongoDB Atlas, you can activate ``Development Mode`` in the MongoDB Realm UI. This will allow you to develop your Realm Database Schema and have it automatically translated into a JSON Schema for Atlas. 
