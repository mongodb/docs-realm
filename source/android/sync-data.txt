.. _android-sync-data:

=========
Sync Data
=========

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. include:: /includes/sync-beta-note.rst

Prerequisites
-------------

Before you can access a synced {+realm+} from the client, you must:

- :ref:`Enable sync <enable-sync>` in the {+ui+}.

- :ref:`Initialize the app <android-quick-start-init-app>` and
  :ref:`authenticate a user <android-quick-start-authenticate>` in
  your client project.

Open a Synced Realm
-------------------

To open a synced :term:`{+realm+}` for a given :term:`partition value`, initialize a
``Realm`` with :java-sdk:`Realm.getInstance()
<io/realm/Realm.html#getInstance-io.realm.RealmConfiguration->` or
:java-sdk:`Realm.getInstanceAsync()
<io/realm/Realm.html#getInstanceAsync-io.realm.RealmConfiguration-io.realm.Realm.Callback->`:

.. tabs-realm-languages::
   
   .. tab::
      :tabid: kotlin

      .. literalinclude:: /examples/generated/android/code/start/SyncDataTest.codeblock.open-a-synced-realm.kt
         :language: kotlin

   .. tab::
      :tabid: java

      .. literalinclude:: /examples/generated/android/code/start/SyncDataTest.codeblock.open-a-synced-realm.java
         :language: java

The :ref:`partition value <partitioning>` specifies which subset of your data to sync.
This is typically a user ID, project ID, store ID, or some other category identifier in
your app that has particular relevance to the current user. 

.. seealso::

   :ref:`Partition Atlas Data into Realms <partitioning>`

Sync Data
---------

The syntax to :ref:`read <android-realm-database-reads>`, :ref:`write
<android-realm-database-writes>`, and
:ref:`watch for changes <android-client-notifications>` on a
synced {+realm+} is identical to the syntax for non-synced {+realms+}. While you work with
local data, a background thread efficiently integrates, uploads, and downloads changesets.

.. important:: When Using Sync, Avoid Writes on the Main Thread

   The fact that {+service-short+} performs sync integrations on a background thread means
   that if you write to your {+realm+} on the main thread, there's a small chance your UI
   could appear to hang as it waits for the background sync thread to finish a write
   transaction. Therefore, it's a best practice :ref:`never to write on the main thread
   when using {+sync+} <android-threading-three-rules>`.

The following code reads a collection of ``Task`` objects, then writes a
new ``Task`` to the {+realm+}:

.. tabs-realm-languages::
   
   .. tab::
      :tabid: kotlin

      .. literalinclude:: /examples/generated/android/code/start/SyncDataTest.codeblock.sync-data.kt
         :language: kotlin

   .. tab::
      :tabid: java

      .. literalinclude:: /examples/generated/android/code/start/SyncDataTest.codeblock.sync-data.java
         :language: java

.. seealso::

   :ref:`Threading <android-client-threading>`

Summary
-------

- Open a synced {+realm+} with the configuration object generated when you pass a :term:`partition value` to the user object's ``SyncConfiguration`` Builder.
- Compared to using a non-synced {+realm+}, there is no special syntax for reading from, writing to, or watching objects on a synced {+realm+}.
- You should avoid writing to a synced {+realm+} on the main thread.
