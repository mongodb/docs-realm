.. _node-sync-changes-between-devices:

============================
Sync Changes Between Devices
============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

.. _node-open-a-synced-realm:

Open a Synced Realm
-------------------
To open a synced {+realm+}, call :js-sdk:`Realm.open() <Realm.html#.open>`. 
Pass in a :js-sdk:`Configuration <Realm.html#~Configuration>`
object, which must include the ``sync`` property defining a 
:js-sdk:`SyncConfiguration <Realm.App.Sync.html#~SyncConfiguration>` object.


.. example::

   In the following example, a synced {+realm+} is opened with a :doc:`schema
   </sdk/node/examples/define-a-realm-object-model>` value of a predefined
   ``TaskSchema`` ``SyncConfiguration`` object that uses the currently logged in
   user  and a partition value of "MyPartition".
   
   .. code-block:: javascript

      const config = {
         schema: [TaskSchema],
         sync: {
            user: app.currentUser,
            partitionValue: "myPartition",
         }
      };
      
      const realm = await Realm.open(config);


.. _node-sync-changes-in-the-background:


Handle a Client Reset Error
---------------------------
To initiate a client reset if an error occurs with the connection to the
{+service+}, define an ``error`` callback function in your
:js-sdk:`SyncConfiguration <Realm.App.Sync.html#~SyncConfiguration>` object.

.. example::
   
   .. code-block:: javascript
      :emphasize-lines: 7

      const config = {
         schema: [TaskSchema],
         sync: {
            user: app.currentUser,
            partitionValue: "myPartition",
         },
         error: (_session, error) => {
            if (error.name === 'ClientReset') {
            let path = realm.path; // realm.path will no be accessible after realm.close()
            realm.close();
            Realm.App.Sync.initiateClientReset(app, path);
            }
         }
      }; 
      const realm = await Realm.open(config);

.. _node-set-the-client-log-level:

Set the Client Log Level
------------------------
You can set the {+realm+} Sync client :js-sdk:`log level
<Realm.App.Sync.html#~LogLevel>` by calling
:js-sdk:`Realm.App.Sync.setLogLevel() <Realm.App.Sync.html#.setLogLevel>` with
your :js-sdk:`Realm.App <Realm.App.html>`.

.. example::

   In the following example, an application developer sets the sync client
   log level to ``"debug"``.
   
   .. code-block:: javascript

      Realm.App.Sync.setLogLevel(app, "debug");

.. _node-multiplex-sync-sessions:

Multiplex Sync Sessions
-----------------------
To enable session multiplexing, call :js-sdk:`Realm.App.Sync.enableSessionMultiplexing() <Realm.App.Sync.html#.enableSessionMultiplexing>` with your :js-sdk:`Realm.App <Realm.App.html>`. 

.. warning::

   Only use session multiplexing if you see errors about reaching the file descriptor limit,
   and you know you are using many sync sessions.

.. example::
   
   .. code-block:: javascript

      Realm.App.Sync.enableSessionMultiplexing(app);
