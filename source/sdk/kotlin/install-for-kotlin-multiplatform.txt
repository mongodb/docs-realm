.. _kotlin-install-kotlin-multiplatform:

===========================================
Install (Kotlin Multiplatform) - Kotlin SDK
===========================================

.. default-domain:: mongodb

.. include:: /includes/kotlin-install-prerequisites.rst

Installation
------------

.. tabs::

   .. tab:: Realm Database
      :tabid: realm-database

      To add local-only Realm Database to your application, make
      the following changes to your shared module Gradle build
      file, typically found at :file:`<project>/shared/build.gradle.kts`:

      - Add :file:`io.realm.kotlin:library-base` to the dependencies
        block of your common module.
      - Add :file:`io.realm.kotlin` to your list of plugins.
      - To use coroutines with the SDK, add the
        :file:`org.jetbrains.kotlinx:kotlinx-coroutines-core`
        to the dependencies block of your common module.

      .. code-block:: kotlin
         :emphasize-lines: 5, 28, 29
         :copyable: false

         plugins {
             kotlin("multiplatform")
             kotlin("native.cocoapods")
             id("com.android.library")
             id("io.realm.kotlin")
         }

         version = "1.0"

         kotlin {
             android()
             iosX64()
             iosArm64()

            cocoapods {
                summary = "Some description for the Shared Module"
                homepage = "Link to the Shared Module homepage"
                ios.deploymentTarget = "14.1"
                podfile = project.file("../iosRealmKMMApp/Podfile")
                 framework {
                    baseName = "shared"
                 }
             }
             
             sourceSets {
                 val commonMain by getting {
                     dependencies {
                         implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.5.2-native-mt")
                         implementation("io.realm.kotlin:library-base:{+kotlin-sdk-version+}")
                     }
                 }
                 val commonTest by getting {
                     dependencies {
                         implementation(kotlin("test-common"))
                         implementation(kotlin("test-annotations-common"))
                     }
                 }
                val androidMain by getting
                val androidTest by getting {
                    dependencies {
                         implementation(kotlin("test-junit"))
                         implementation("junit:junit:4.13.2")
                     }
                 }
                 val iosX64Main by getting
                 val iosArm64Main by getting
                 
                 val iosMain by creating {
                     dependsOn(commonMain)
                     iosX64Main.dependsOn(this)
                     iosArm64Main.dependsOn(this)
                 }
                 val iosX64Test by getting
                 val iosArm64Test by getting
                 val iosTest by creating {
                     dependsOn(commonTest)
                     iosX64Test.dependsOn(this)
                     iosArm64Test.dependsOn(this)
                 }
             }
         }

         android {
             compileSdk = 30
             sourceSets["main"].manifest.srcFile("src/androidMain/AndroidManifest.xml")
             defaultConfig {
                 minSdk = 28
                 targetSdk = 30
             }
         }

      Then, add :file:`classpath("io.realm.kotlin:gradle-plugin:{+kotlin-sdk-version+}")`
      to the :file:`buildscript.dependencies` block of your project-level
      Gradle build file, typically found at :file:`<project>/build.gradle.kts`:

      .. code-block:: kotlin
         :emphasize-lines: 10
         :copyable: false

         buildscript {
              repositories {
                  gradlePluginPortal()
                  google()
                  mavenCentral()
              }
              dependencies {
                  classpath("org.jetbrains.kotlin:kotlin-gradle-plugin:1.6.10")
                  classpath("com.android.tools.build:gradle:7.1.1")
                  classpath("io.realm.kotlin:gradle-plugin:{+kotlin-sdk-version+}")
              }
          }

          allprojects {
              repositories {
                  google()
                  mavenCentral()
              }
          }

          tasks.register("clean", Delete::class) {
              delete(rootProject.buildDir)
          }

   .. tab:: Sync
      :tabid: sync

      To add Realm Database and Sync to your application, make
      the following changes to your shared module Gradle build
      file, typically found at :file:`shared/build.gradle.kts`:

      - Add :file:`io.realm.kotlin:library-sync` to the dependencies
        block of your common module.
      - Add :file:`io.realm.kotlin` to your list of plugins.
      - To use coroutines with the SDK, add the
        :file:`org.jetbrains.kotlinx:kotlinx-coroutines-core`
        to the dependencies block of your common module.

      .. code-block:: kotlin
         :emphasize-lines: 5, 28, 29
         :copyable: false

         plugins {
             kotlin("multiplatform")
             kotlin("native.cocoapods")
             id("com.android.library")
             id("io.realm.kotlin")
         }

         version = "1.0"

         kotlin {
             android()
             iosX64()
             iosArm64()

            cocoapods {
                summary = "Some description for the Shared Module"
                homepage = "Link to the Shared Module homepage"
                ios.deploymentTarget = "14.1"
                podfile = project.file("../iosRealmKMMApp/Podfile")
                 framework {
                    baseName = "shared"
                 }
             }
             
             sourceSets {
                 val commonMain by getting {
                     dependencies {
                         implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.5.2-native-mt")
                         implementation("io.realm.kotlin:library-sync:{+kotlin-sdk-version+}")
                     }
                 }
                 val commonTest by getting {
                     dependencies {
                         implementation(kotlin("test-common"))
                         implementation(kotlin("test-annotations-common"))
                     }
                 }
                val androidMain by getting
                val androidTest by getting {
                    dependencies {
                         implementation(kotlin("test-junit"))
                         implementation("junit:junit:4.13.2")
                     }
                 }
                 val iosX64Main by getting
                 val iosArm64Main by getting
                 
                 val iosMain by creating {
                     dependsOn(commonMain)
                     iosX64Main.dependsOn(this)
                     iosArm64Main.dependsOn(this)
                 }
                 val iosX64Test by getting
                 val iosArm64Test by getting
                 val iosTest by creating {
                     dependsOn(commonTest)
                     iosX64Test.dependsOn(this)
                     iosArm64Test.dependsOn(this)
                 }
             }
         }

         android {
             compileSdk = 30
             sourceSets["main"].manifest.srcFile("src/androidMain/AndroidManifest.xml")
             defaultConfig {
                 minSdk = 28
                 targetSdk = 30
             }
         }

      Then, add :file:`io.realm.kotlin:gradle-plugin`
      to the :file:`buildscript.dependencies` block of your project-level
      Gradle build file, typically found at :file:`<project>/build.gradle.kts`:

      .. code-block:: kotlin
         :emphasize-lines: 10
         :copyable: false

         buildscript {
              repositories {
                  gradlePluginPortal()
                  google()
                  mavenCentral()
              }
              dependencies {
                  classpath("org.jetbrains.kotlin:kotlin-gradle-plugin:1.6.10")
                  classpath("com.android.tools.build:gradle:7.1.1")
                  classpath("io.realm.kotlin:gradle-plugin:{+kotlin-sdk-version+}")
              }
          }

          allprojects {
              repositories {
                  google()
                  mavenCentral()
              }
          }

          tasks.register("clean", Delete::class) {
              delete(rootProject.buildDir)
          }

   .. note:: Android Module Dependencies

      If you use any part of the SDK inside the Android module, add the
      SDK's compile-time dependency to your Android module ``build.gradle.kts``:

   .. code-block:: kotlin
      :copyable: false

      dependencies {
         compileOnly("io.realm.kotlin:library:{+kotlin-sdk-version+}")
      }

After updating the Gradle configuration,
resolve the dependencies by clicking :guilabel:`File` >
:guilabel:`Sync Project with Gradle Files` in the Android Studio menu bar.
You can now use the Kotlin SDK in your application.


