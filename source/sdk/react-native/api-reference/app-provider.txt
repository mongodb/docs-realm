.. _react-native-app-provider:

==========================
AppProvider (@realm/react)
==========================

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 3
   :class: singlecol

.. code:: typescript
   :copyable: false
   :caption: Type signature

   AppProvider(props, context?): null | ReactElement<any, any>

Components nested within ``AppProvider`` can access your App Services App
and use the ``AppProvider`` hooks.

Props
-----

All properties of :realm-react-sdk:`AppConfiguration 
<types/Realm.AppConfiguration.html>` can be passed as props to ``AppProvider``.

Configure AppProvider
---------------------

To set up your App client, pass the App ID string
to the ``id`` prop of the ``AppProvider``.
Wrap any components that need to access the App with ``AppProvider``.

.. literalinclude:: /examples/generated/react-native/ts/app-provider.test.snippet.app-provider.tsx
   :language: typescript

.. include:: /includes/multiple-app-client-details-and-app-config-cache.rst

Hooks Used with AppProvider
---------------------------

.. _react-native-use-auth:

useAuth()
~~~~~~~~~

.. code:: typescript
   :copyable: false
   :caption: Type signature

   useAuth(): UseAuth

``useAuth`` has an authentication method for every App Services
authentication provider.

result
``````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   result: AuthResult

Result of authentication hook operation. For example, ``result.operation`` gives
you the name of the current operation.

*Enum values* 

- ``state``. Can be "not-started", "pending", "success", "error".
- ``operation``. For a list of all operation names, refer to the
  :realm-react-sdk:`API documentation <enums/AuthOperationName.html>`.
- ``pending``. Can be ``true`` or ``false``.
- ``success``. Can be ``true`` or ``false``.
- ``error``. Error-based object or undefined.

logIn(credentials)
``````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logIn(credentials: Realm.Credentials): void

Logs in a user with any authentication mechanism supported by
Realm. If called when a user is logged in, the current user switches to
the new user. Usually, it's better to use the more specific login
methods.

.. code:: typescript

  const {logIn, result} = useAuth();

  useEffect(() => logIn(Realm.Credentials.anonymous()), []);

  if(result.pending) {
    return (<LoadingSpinner/>)
  }

  if(result.error) {
    return (<ErrorComponent/>)
  }

  if(result.success) {
    return (<SuccessComponent/>)
  }
  //...

*Parameters*

- ``credentials``. A Realm credential supplied by any supported Realm
  authentication.

logInWithAnonymous()
````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithAnonymous(): void

Log in with the anonymous authentication provider.

.. code:: typescript

   const {logInWithAnonymous, result} = useAuth();
   const performLogin = () => {
      logInWithAnonymous();
   };

logInWithApiKey(key)
````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithApiKey(key: string): void

Log in with an API key.

.. code:: typescript

   const {logInWithApiKey, result} = useAuth();
   const performLogin = () => {
   const key = getApiKey(); // user defined function
      logInWithApiKey(key);
   };

*Parameters*

- ``key``. A string that is linked to an App Services user.

logInWithEmailPassword(credentials)
```````````````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithEmailPassword(credentials: {
     email: string;
     password: string;
   }): void

Log in with Email/Password.

.. code:: typescript

   const {logInWithEmailPassword, result} = useAuth();
   const [email, setEmail] = useState('');
   const [password, setPassword] = useState('');

   const performLogin = () => {
      logInWithEmailPassword({email, password});
   };

*Parameters*

- ``credentials``. An object with ``email`` and ``password`` fields.

logInWithJWT(credentials)
`````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithJWT(token: string): void

Log in with a JSON Web Token (JWT).
       
.. code:: typescript

   const {logInWithJWT, result} = useAuth();

   const performLogin = () => {
   const token = authorizeWithCustomerProvider(); // user defined function
      logInWithJWT(token);
   };

*Parameters*

- ``credentials``. A string representation of a user's JWT.

logInWithGoogle(credentials)
````````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithGoogle(credentials: {
        idToken: string;
    } | {
        authCode: string;
    }): void;

Log in with Google.
       
.. code:: typescript

   const {logInWithGoogle, result} = useAuth();

   const performLogin = () => {
   const token = getGoogleToken(); // user defined function
      logInWithGoogle({idToken: token});
   };

*Parameters*

- ``credentials``. An object with and ``idToken`` field that should contain
  the string token you get from Google Identity Services.

logInWithApple(idToken)
```````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithApple(idToken: string): void;

Log in with Apple.
       
.. code:: typescript

   const {logInWithApple, result} = useAuth();

   const performLogin = () => {
   const token = getAppleToken(); // user defined function
      logInWithApple(token);
   };

*Parameters*

- ``idToken``. A string you get from an Apple SDK.

logInWithFacebook(accessToken)
``````````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithFacebook(accessToken: string): void;

Log in with Facebook.
       
.. code:: typescript

   const {logInWithFacebook, result} = useAuth();

   const performLogin = () => {
   const token = getFacebookToken(); // user defined function
      logInWithFacebook(token);
   };

*Parameters*

- ``accessToken``. A string you get from the Facebook SDK.

logInWithFunction(payload)
``````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logInWithFunction<PayloadType extends Record<string, unknown>>(payload: PayloadType): void;

Log in with a custom function.
       
.. code:: typescript

   const {logInWithFunction, result} = useAuth();

   const performLogin = () => {
   const customPayload = getAuthParams(); // user defined arguments
      logInWithFunction(customPayload);
   };

*Parameters*

- ``payload``. An object that contains user information you want to pass to
  the App Services function that processes log in requests.

logOut()
````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logOut(): void;

Logs out the current user.
       
.. code:: typescript

   const {logOut, result} = useEmailPasswordAuth();
   const performLogout = () => {
      logOut();
   }

*Parameters*

- none

.. _react-native-use-emailpassword-auth:

useEmailPasswordAuth()
~~~~~~~~~~~~~~~~~~~~~~

.. code:: typescript
   :copyable: false
   :caption: Type signature

   result: AuthResult

Result of authentication hook operation. For example, ``result.operation`` gives
you the name of the current operation.

*Enum values* 

- ``state``. Can be "not-started", "pending", "success", "error".
- ``operation``. For a list of all operation names, refer to the
  :realm-react-sdk:`API documentation <enums/AuthOperationName.html>`.
- ``pending``. Can be ``true`` or ``false``.
- ``success``. Can be ``true`` or ``false``.
- ``error``. Error-based object or undefined.

logIn(credentials)
``````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logIn(credentials: { email: string; password: string }): void;

Logs a user in using an email and password. You could also call
``logIn(Realm.Credentials.emailPassword(email, password))``. Returns a
``Realm.User`` instance of the logged-in user.

.. code:: typescript

   const {logIn, result} = useEmailPasswordAuth();

   const [email, setEmail] = useState('');
   const [password, setPassword] = useState('');

   const performLogin = () => {
      logIn({email, password});
   };

   if(result.pending) {
      return (<LoadingSpinner/>)
   }

   if(result.error) {
      return (<ErrorComponent/>)
   }

   if(result.success) {
      return (<SuccessComponent/>)
   }
   //...

*Parameters*

- ``credentials``. An object that contains ``email`` and ``password`` properties.

logOut()
````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   logOut(): void;

Logs out the current user.
       
.. code:: typescript

   const {logOut, result} = useEmailPasswordAuth();
   const performLogout = () => {
      logOut();
   }

register(args)
``````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   register(args: { email: string; password: string }): void;

Registers a new user. Requires a user email and password.
       
.. code:: typescript

   const {register, result} = useEmailPasswordAuth();

   const [email, setEmail] = useState('');
   const [password, setPassword] = useState('');

   const performRegister = () => {
      register({email, password});
   };

*Parameters*

- ``args``. An object that contains ``email`` and ``password`` properties.

confirm(args)
`````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   confirm(args: { token: string; tokenId: string }): void;

Confirms a user account. Requires a ``token`` and ``tokenId``.
       
.. code:: typescript

   const {confirm, result} = useEmailPasswordAuth();

   const performConfirmation = () => {
      confirm({token, tokenId});
   };

*Parameters*

- ``args``. An object that contains ``token`` and ``tokenId`` properties.

resendConfirmationEmail(args)
`````````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   resendConfirmationEmail(args: { email: string }): void;

Resends a confirmation email.

.. code:: typescript

   const {resendConfirmationEmail, result} = useEmailPasswordAuth();
   const [email, setEmail] = useState('');

   const performResendConfirmationEmail = () => {
      resendConfirmationEmail({email});
   };

*Parameters*

- ``args``. An object that contains an ``email`` property.

retryCustomConfirmation(args)
`````````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   retryCustomConfirmation(args: { email: string }): void;

Retries confirmation with a custom function.

.. code:: typescript

   const {retryCustomConfirmation, result} = useEmailPasswordAuth();
   const [email, setEmail] = useState('');

   const performRetryCustomConfirmation = () => {
      retryCustomConfirmation({email});
   };

*Parameters*

- ``args``. An object that contains an ``email`` property.

sendResetPasswordEmail(args)
`````````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   sendResetPasswordEmail(args: { email: string }): void;

Sends a password reset email.

.. code:: typescript

   const {sendResetPasswordEmail, result} = useEmailPasswordAuth();
   const [email, setEmail] = useState('');

   const performSendResetPasswordEmail = () => {
      sendResetPasswordEmail({email});
   };

*Parameters*

- ``args``. An object that contains an ``email`` property.

resetPassword(args)
```````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   resetPassword(args: { token: string; tokenId: string; password: string }): void;

Completes resetting a user's password.

.. code:: typescript

   const {resetPassword, result} = useEmailPasswordAuth();
   const [password, setPassword] = useState('');

   const performResetPassword = () => {
      resetPassword({token, tokenId, password});
   };

*Parameters*

- ``args``. An object that contains ``token``, ``tokenId``, and ``password``
  properties.

callResetPasswordFunction(args, restArgs)
`````````````````````````````````````````

.. code:: typescript
   :copyable: false
   :caption: Type signature

   callResetPasswordFunction<Args extends unknown[] = []>(
    args: {
      email: string;
      password: string;
    },
    ...restArgs: Args
  ): void;

Calls your App Services backend password reset function. Can pass arguments to
the function as needed.

.. code:: typescript

   const {callResetPasswordFunction, result} = useEmailPasswordAuth();
   const [email, setEmail] = useState('');
   const [password, setPassword] = useState('');

   const performResetPassword = () => {
      callResetPasswordFunction({email, password}, "extraArg1", "extraArg2");
   };

*Parameters*

- ``args``. An object that contains ``email`` and ``password`` properties.
- ``restArgs``. Additional arguments that you need to pass to your custom
  reset password function.

.. _react-native-use-app-hook:

useApp()
~~~~~~~~

.. code:: typescript
   :copyable: false
   :caption: Type signature

   useApp<FunctionsFactoryType, CustomDataType>(): Realm.App<FunctionsFactoryType, CustomDataType>

The ``useApp()`` hook provides access to the :js-sdk:`Realm.App <Realm.App.html>`
instance.

.. literalinclude:: /examples/generated/react-native/ts/use-app.test.snippet.use-app.tsx
   :language: typescript

*Returns*

- ``Realm.App``
  An instance of the current ``Realm.App`` created by ``AppProvider``.
