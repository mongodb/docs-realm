.. _react-native-update-objects:

================================
CRUD - Update - React Native SDK
================================

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

About the Examples on this Page
-------------------------------
The examples on this page use the following schemas:

.. tabs-realm-languages::
      
   .. tab::
      :tabid: typescript
      
      .. literalinclude:: /examples/generated/reactnative/ts/Task.snippet.ts-task-schema.ts
         :language: typescript

   .. tab::
      :tabid: javascript

      .. literalinclude:: /examples/generated/reactnative/js/Task.snippet.js-task-schema.js
         :language: javascript

.. _react-native-update-an-object:

Update an Object
----------------

You can add, modify, or delete properties of a Realm object inside of a
:ref:`write transaction <react-native-write-transactions>` in the same way that
you would update any other JavaScript object.

In the following example of a ``TaskItem`` component we:

- Retrieve the realm instance using the useRealm() hook. 
- Retrieve a task by calling ``useObject()` with "Task" and the ``_id`` parameter of the component.
- Create a component method ``incrementTaskProgress()`` that performs a write transaction and increments the task's ``progressMinutes``.
- Render the task's ``name`` and ``progressMinutes`` in the UI.
- Add an `onPress <https://reactnative.dev/docs/handling-touches>`__ event on the "increment" button that calls ``incrementTaskProgress()``.

.. tabs-realm-languages::
      
   .. tab::
      :tabid: typescript
      
      .. literalinclude:: /examples/generated/reactnative/ts/update-test.snippet.crud-update-object.tsx
         :language: typescript
         :emphasize-lines: 2-3, 6-8
         :linenos:

   .. tab::
      :tabid: javascript

      .. literalinclude:: /examples/generated/reactnative/js/update-test.snippet.crud-update-object.jsx
         :language: javascript
         :emphasize-lines: 2-3, 6-8
         :linenos:

.. tip:: Update Related and Embedded Objects
   
   To update a property of an :ref:`embedded object <react-native-embedded-objects>` or
   a :ref:`related object <react-native-client-relationships>`, modify the property with
   :mdn:`dot-notation or bracket-notation
   <Web/JavaScript/Reference/Operators/Property_accessors>` as if it were in a
   regular, nested object.

.. _react-native-upsert-an-object:

Upsert an Object
----------------

To upsert an object within a write transaction, call :js-sdk:`Realm.create()
<Realm.html#create>` with the update mode set to ``modified``. The operation
either inserts a new object with the given primary key or updates an existing
object that already has that primary key.

.. note:: Upserting Requires ``Realm.create()``

   While you can create new :js-sdk:`Realm Objects <Realm.Object.html>` by
   calling the :mdn:`new <Web/JavaScript/Reference/Operators/new>` operator
   within a write transaction, you **must** call ``Realm.create()`` to upsert an
   object.

In the following example of a ``CreateTaskItem`` component we:

-  Get access to an open realm instance by calling the ``useRealm()`` hook within the component. 
- Perform a write transaction, and :ref:`create <react-native-create-a-new-object>` a ``Task`` object with an ``_id`` value of ``1234``.
- Call `` Realm.create()`` inside the write transaction to upsert a ``Task`` object by specifying the same ``_id`` and a different``progressMinutes`` and the update mode set to "modified".
- Render the task's ``name`` and ``progressMinutes`` in the UI, showing the modified progress. 

.. tabs-realm-languages::
      
   .. tab::
      :tabid: typescript
      
      .. literalinclude:: /examples/generated/reactnative/ts/update-test.snippet.crud-upsert-object.tsx
         :language: typescript
         :emphasize-lines: 2, 8, 13
         :linenos:

   .. tab::
      :tabid: javascript

      .. literalinclude:: /examples/generated/reactnative/js/update-test.snippet.crud-upsert-object.jsx
         :language: javascript
         :emphasize-lines: 2, 8, 13
         :linenos:

.. _react-native-update-a-collection:
.. _react-native-bulk-update:

Bulk Update a Collection
------------------------

To apply an update to a collection of objects, iterate through the collection
(e.g. with :mdn:`for...of
<Web/JavaScript/Reference/Statements/for...of>`). In the loop, update each object individually.

In the following example of a ``TaskDashboard`` component, we retrieve all tasks
in the realm instance by passing "Task" to the ``useQuery`` hook. When an
application user presses the "Reset Progress" button, triggering the
``resetProgressOnAllTasks()`` method. Within a write transaction, we bulk update
all the tasks by looping through them using ``for...of`` and set their
``progressMinutes`` to 0.

.. tabs-realm-languages::
      
   .. tab::
      :tabid: typescript
      
      .. literalinclude:: /examples/generated/reactnative/ts/update-test.snippet.crud-bulk-update.tsx
         :language: typescript
         :emphasize-lines: 2-3, 6-10
         :linenos:

   .. tab::
      :tabid: javascript

      .. literalinclude:: /examples/generated/reactnative/js/update-test.snippet.crud-bulk-update.jsx
         :language: javascript
         :emphasize-lines: 2-3, 6-10
         :linenos: