=============================
Link a New Identity to a User
=============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol


Overview
--------

MongoDB Realm provides multiple ways for you to integrate user
authentication into your apps. When a user logs in with a specific
provider, MongoDB Realm associates an ``identity`` object that contains
the provider type with the user. Since there are multiple
:doc:`Authentication Providers </authentication/providers>`, you may
want to link an additional, new identity to an existing user account.
Consider the following example:

A developer using MongoDB Realm has an app that allows users to explore
the app anonymously without signing up upon first viewing. After working
with an app, a user decides to create an account with their
Email/Password.  The user now has data associated with their anonymous
identity, and they would like to link it to their newly created
Email/Password user account. They can do this by calling Realm's
``linkWithCredential()`` method on the ``StitchUser`` instance.

.. tabs-stitch-sdks::
   :hidden: true

   .. tab::
      :tabid: javascript

      To provide user account linking in your code, add your app's
      hosted domain to the list of :guilabel:`Allowed Request Origins`
      in :guilabel:`General Settings` and then use the
      :js-sdk:`linkWithCredential() <interfaces/stitchuser.html#linkwithcredential>` method of the
      :guilabel:`StitchUser` class.
   .. tab::
      :tabid: android

      To provide user account linking in your code, add your app's
      hosted domain to the list of :guilabel:`Allowed Request Origins`
      in :guilabel:`General Settings` and then use the
      :android-sdk:`linkWithCredential() <com/mongodb/stitch/android/core/auth/StitchUser.html#linkWithCredential-com.mongodb.stitch.core.auth.StitchCredential->` method
      of the :guilabel:`StitchUser` class.     
   .. tab::
      :tabid: ios

      To provide user account linking in your code, add your app's
      hosted domain to the list of :guilabel:`Allowed Request Origins`
      in :guilabel:`General Settings` and then use the :ios-sdk:`linkWithCredential() <Protocols/StitchUser.html#/s:10StitchCore0A4UserP4linky0aB3SDK0A10Credential_p04withF0_yAA0A6ResultOyAaB_pGctF>`
      method of the :guilabel:`StitchUser` class. 

.. warning::

   Accounts created with the Email/Password authentication provider must
   in the "Pending User Login" user status. This means that the user has
   received and clicked their confirmation email, but has not yet
   attempted to login after confirming their account.

Usage
-----

The following usage example simulates an anonymous user login with the
``loginWithCredential()`` method. This method returns the anonymous
user. The anonymous user is then linked to an existing user created with
the username/password authentication provider by calling
``linkWithCredential()``.


.. tabs-stitch-sdks::

   tabs:
     - id: javascript
       content: | 
         .. include:: ./usage-examples/linking/js.rst
     - id: android
       content: |
         .. include:: ./usage-examples/linking/android.rst
     - id: ios
       content: |
         .. include:: ./usage-examples/linking/ios.rst
